# 飞机大战 - 敌机伤害系统设计说明

## 系统概述
设计了一套完整的敌机子弹伤害系统，解决了之前敌机子弹无法对玩家造成伤害的问题。

## 伤害设计原则

### 1. 平衡性原则
- 基础敌机：低伤害、单发
- 重型敌机：中等伤害、多发散射
- 精英敌机：中等伤害、多发扇形
- 拦截机：低伤害、高速追踪
- 轰炸机：高伤害、单发重型炸弹

### 2. 差异化设计
不同敌机类型具有不同的伤害模式和特点

## 敌机类型与伤害设定

### 基础敌机 (basic/scout/fighter)
- **子弹类型**: `enemy`
- **伤害值**: 10点
- **特点**: 单发子弹，基础伤害
- **发射模式**: 瞄准玩家的单发射击

### 重型敌机 (heavy)
- **子弹类型**: `heavy_bullet`
- **伤害值**: 15点
- **特点**: 3发散射弹幕
- **发射模式**: 3发横向散射，覆盖范围更广

### 精英敌机 (elite)
- **子弹类型**: `elite_bullet`
- **伤害值**: 12点
- **特点**: 5发扇形弹幕，带旋转效果
- **发射模式**: 5发扇形发射，角度分散

### 拦截机 (interceptor)
- **子弹类型**: `interceptor_bullet`
- **伤害值**: 8点
- **特点**: 2发快速子弹，具有追踪能力
- **发射模式**: 双发高速射击，轻微追踪

### 轰炸机 (bomber)
- **子弹类型**: `bomb`
- **伤害值**: 25点
- **特点**: 单发重型炸弹，具有爆炸范围
- **发射模式**: 单发重型炸弹，范围伤害

## 技术实现

### 1. 碰撞检测修复
```javascript
// 扩展敌机子弹类型识别
const isEnemyBullet = ['enemy', 'heavy_bullet', 'elite_bullet', 'interceptor_bullet', 'bomb'].includes(bullet.type);
```

### 2. 玩家伤害处理优化
```javascript
// 统一的敌机子弹识别和处理
const enemyBulletTypes = ['enemy', 'heavy_bullet', 'elite_bullet', 'interceptor_bullet', 'bomb'];
if (enemyBulletTypes.includes(other.type)) {
    this.takeDamage(other.getDamage());
}
```

### 3. 伤害反馈系统
- **浮动伤害数字**: 显示具体伤害值
- **护盾阻挡提示**: 显示护盾阻挡效果
- **受击特效**: 爆炸粒子效果
- **无敌时间**: 0.8秒防连击保护

## 视觉反馈增强

### 1. 浮动伤害文字
- 红色数字显示伤害值
- 青色文字显示护盾阻挡
- 带有重力和渐隐效果
- 随机偏移避免重叠

### 2. 受击特效
- 爆炸粒子效果
- 子弹销毁特效
- 护盾闪烁效果

### 3. 控制台日志
- 详细的伤害信息记录
- 便于调试和平衡性调整

## 游戏平衡性

### 玩家血量: 100点
- 基础敌机: 需要10发击杀
- 重型敌机: 需要7发击杀  
- 精英敌机: 需要9发击杀
- 拦截机: 需要13发击杀
- 轰炸机: 需要4发击杀

### 防护机制
- **护盾**: 完全免疫伤害
- **无敌时间**: 0.8秒免伤
- **复活保护**: 5秒金色护盾

## 特殊机制

### 1. 穿透机制
- 某些子弹具有穿透能力
- 穿透次数用完后才销毁

### 2. 爆炸机制
- 轰炸机炸弹具有范围伤害
- 爆炸半径内造成伤害

### 3. 追踪机制
- 拦截机子弹具有轻微追踪能力
- 增加命中率但伤害相对较低

## 系统优势

1. **完整性**: 覆盖所有敌机类型
2. **平衡性**: 不同威胁级别的合理伤害分配
3. **反馈性**: 丰富的视觉和听觉反馈
4. **可扩展性**: 易于添加新的敌机类型和武器

这套伤害系统确保了游戏的挑战性和公平性，同时提供了丰富的视觉反馈，增强了游戏体验。 